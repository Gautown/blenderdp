<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>内容管理系统</title>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <link rel="stylesheet" href="./custom.css" />
  </head>
  <body>
    <!-- Decap CMS will be injected here -->
    <script>
      // 注册自定义媒体库组件以避免错误
      CMS.registerMediaLibrary({
        name: 'static',
        init: () => ({
          show: (options = {}) => {
            console.log('Static media library show called with options:', options);
            return Promise.resolve();
          },
          hide: () => {
            console.log('Static media library hide called');
            return Promise.resolve();
          },
          onClearControl: () => {
            console.log('Static media library onClearControl called');
            return Promise.resolve();
          },
          enableStandalone: () => false,
        })
      });
      
      // 初始化 Decap CMS
      if (document.location.hostname === "localhost") {
        // 本地开发环境
        CMS.init();
      } else {
        // 生产环境
        CMS.init({
          config: {
            backend: {
              name: 'git-gateway',
              branch: 'main',
              site_domain: 'gautown.top'
            },
            media_library: {
              name: 'static'
            }
          }
        });
      }
    </script>
  </body>
</html>