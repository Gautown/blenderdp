---
import ContentLayout from '../../layouts/ContentLayout.astro';
import { getCollection, getEntry, render } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const abouts = await getCollection('about');
  return abouts.map(about => ({
    params: { slug: about.slug },
    props: { slug: about.slug },
  }));
}

const { slug } = Astro.props;
const about = await getEntry('about', slug) as CollectionEntry<'about'>;
const { Content } = await render(about);

// 获取随机推荐内容（示例数据）
const randomRecommendations = [
  { title: "推荐作品1", url: "/portfolio/recommend1", type: "作品" },
  { title: "推荐工具1", url: "/tools/recommend1", type: "工具" },
  { title: "推荐笔记1", url: "/notes/recommend1", type: "笔记" },
];

// 获取最新文章（示例数据）
const latestArticles = [
  { title: "最新作品1", url: "/portfolio/latest1", date: "2023-06-01" },
  { title: "最新工具1", url: "/tools/latest1", date: "2023-05-28" },
  { title: "最新笔记1", url: "/notes/latest1", date: "2023-05-25" },
];

// 获取热门标签（示例数据）
const popularTags = [
  { name: "前端", count: 15, url: "/tags/frontend" },
  { name: "设计", count: 12, url: "/tags/design" },
  { name: "React", count: 10, url: "/tags/react" },
  { name: "Node.js", count: 8, url: "/tags/nodejs" },
];
---

<ContentLayout 
  title={about.data.title}
  description={about.data.description}
  breadcrumbLinks={[
    { href: '/', label: '首页' },
    { href: '/about', label: '关于' },
    { href: '#', label: '正文' }
  ]}
  randomRecommendations={randomRecommendations}
  latestArticles={latestArticles}
  popularTags={popularTags}
>
  <article class="about-detail">
    <h1>{about.data.title}</h1>
    
    <div class="about-meta">
      <p>{about.data.date ? new Date(about.data.date).toLocaleDateString('zh-CN') : ''}</p>
    </div>
    
    {about.data.thumbnail && (
      <img 
        src={about.data.thumbnail} 
        alt={about.data.title} 
        class="about-image"
        onerror="this.onerror=null;this.src='/images/noimg.gif';"
      />
    )}
    
    <div class="about-content">
      <Content />
    </div>
  </article>
</ContentLayout>

<style>
  .about-detail h1 {
    color: #2c3e50;
    margin-bottom: 1rem;
  }
  
  .about-meta {
    color: #666;
    border-bottom: 1px solid #eee;
    padding-bottom: 1rem;
    margin-bottom: 2rem;
  }
  
  .about-image {
    width: 100%;
    height: 300px;
    object-fit: cover;
    background-color: #f5f5f5;
    margin-bottom: 2rem;
  }
  
  .about-content {
    line-height: 1.8;
  }
</style>